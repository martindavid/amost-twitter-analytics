---
- name: setup CouchDB
  hosts: DB
  remote_user: ubuntu
  become: yes

  tasks:
  - name: install dependencies
    apt: name={{ item }} state=present
    with_items:
    - curl

  - name: add repository for couch
    apt_repository:
      repo: ppa:couchdb/stable
      state: present
  
  - name: install CouchDB
    apt: 
      name: couchdb
      update_cache: yes
      state: present

  - name: Restart CouchDB service
    systemd:
      state: restarted
      daemon_reload: yes
      name: couchdb
      